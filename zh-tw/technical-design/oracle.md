# Oracle Construction

在加密貨幣和去中心化金融（DeFi）的世界中，**及時且準確地獲取鏈外數據至關重要。** 由於智能合約無法直接訪問外部系統或數據來源，預言機充當了這一差距的橋樑，將外部信息帶入區塊鏈。必須提供可信賴的數據服務，以確保結算的完全透明和可追溯性，同時最大限度地減少可能的爭議。

以高度去中心化、可靠性和適應性著稱的**ChainLink**預言機服務已被選為SOFA獲取鏈外數據的主要方式。此外，使用ChainLink價格饋送還有**保護協議免受“閃電貸攻擊”的額外好處**，而**數據饋送的來源將來自Coinbase等知名交易平台**，以確保數據的神聖性。

![](../../static/chainlink.png)

SOFA利用[APRO Oracle](https://www.apro.com)來保護我們在多條鏈上的資產。來自**APRO Oracle**的支持和保護使我們能夠維持鏈上資產的穩定性和安全性。欲了解更多信息，請參閱[APRO Oracle文檔](https://docs.apro.com/en)。

![](../../static/apro.jpg)

## 現貨價格 / 到期價格

通過預言機在鏈上獲取標的資產的當前價格通常有兩種方式：

- 調用像Uniswap這樣的去中心化交易所（DEX）的合約來獲取標的資產的價格或時間加權平均價格（TWAP）
- 通過像ChainLink這樣的預言機服務提供的數據饋送獲取資產價格

考慮到結算價格需要盡可能接近CeFi交易所的價格（以便用戶或做市商進行對沖）以及安全原因（避免操縱和攻擊），我們**選擇ChainLink的數據饋送作為我們到期價格的預言機來源**。

通過ChainLink的去中心化數據來源，這些來源從不同的交易所聚合價格信息，我們確保我們的智能合約執行基於最新、可靠且最公平的公開可用價格數據集。

## 從歷史收盤價計算的價格

對於像Rangebound這樣的產品，需要知道從鑄造開始到到期的標的代幣的最高和最低價格，以計算最終支付。常見的鏈上通常無法提供此數據，因為鏈上預言機不提供連續的時間序列數據。

我們沒有部署自己的預言機合約作為（常見的）中心化妥協，而是在**ChainLink的Functions產品**中找到了答案。得益於最新的創新，我們能夠以去中心化的方式調用鏈外API，並通過像典型數據饋送一樣的去中心化節點將獲得的數據發布到鏈上。

![](../../static/KxYlbnS0IoEtX6xAxV1uB0WKsLg.png)

## 自動化定期更新服務

SOFA利用ChainLink Automation來保證價格定期自動更新並推送到區塊鏈。ChainLink Automation提供了一個去中心化網絡，智能合約可以在其中安排並自動執行複雜任務，包括間隔數據更新、觸發事件，甚至是關鍵合約調整。這**確保鏈上價格始終保持最新，並為SOFA的連接dApps網絡提供數據信心**。

![](../../static/FESNbrjpEobC0DxtBz5u6Og0sgf.png)

## 去中心化和可追溯性

忠於我們的核心DeFi精神，**SOFA的價格數據檢索過程將始終完全去中心化**，在合約層面提供完整的審計可追溯性。我們對透明處理的倡導確保系統中的每一步都可以由用戶公開驗證，價格數據細節如提供者來源和聚合邏輯始終可觀察。

## 預言機服務的持續創新

雖然ChainLink仍然是DeFi數據可靠性的黃金標準，但SOFA不斷探索並保持對預言機服務最新創新的了解。我們意識到過度依賴有限的提供者來源，將**努力在技術上盡可能多樣化我們的協議輸入**。

從長遠來看，SOFA致力於為用戶提供一個強大、透明、去中心化和可持續的數據獲取系統，能夠保護用戶利益，同時確保運營的長久性。