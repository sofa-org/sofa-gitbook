# واجهات برمجة التطبيقات المفتوحة لـ DApp

تعتبر تطبيقاتنا الحالية على sofa.org ميزة حيوية في سير العمل وهي الطريقة الرئيسية التي يتفاعل بها المستخدمون مع بروتوكولات SOFA. ومع ذلك، نشجع المطورين الآخرين على تمكين الوصول والاتصال بـ SOFA من خلال تطبيقاتهم الخاصة أيضًا لتعظيم نمو نظامنا البيئي. نحن نعتبر هؤلاء شركاء "الوسيط" لدينا ونشجع الأطراف المهتمة على الاتصال بفريق SOFA للحصول على مزيد من المعلومات حول واجهات برمجة التطبيقات.

## DNT

### استعلام قائمة RFQ الموصى بها لـ DNT

```
GET /rfq/dnt/recommended-list
```

**معلمات الإدخال**

| **اسم الحقل**       | **مطلوب**  | **النوع** | **الوصف**                                                                                           |
| -------------------- | ------------- | -------- | ----------------------------------------------------------------------------------------------------------- |
| vault              | true          | string   | معلومات العقد                                                                                                   |
| chainId            | true          | int      | معرف السلسلة                                                                                                               |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | int          | 0 يشير إلى أن النتيجة المرجعة طبيعية   |
| message        | string       | رسالة خطأ تم إرجاعها في حالة حدوث استثناء |
| value          | list[object] | كما هو موضح أدناه                                               |

كائن

| **اسم الحقل**               | **النوع**     | **الوصف**                                                                                   |
| ---------------------------- | ------------ | ------------------------------------------------------------------------------------------------- |
| rfqId                        | number       | معرف RFQ                                                                                |
| chainId                      | int          | معرف السلسلة                                                                                          |
| vault                        | string       | عنوان العقد                                                                                  |
| riskType                     | string       | نوع المخاطر: محمي، محفوف بالمخاطر                                                                       |
| forCcy                       | string       | العملة الأساسية                                                                               |
| domCcy                       | string       | زوج العملات                                                                                     |
| depositCcy                   | string       | عملة الاشتراك                                                                             |
| lowerBarrier                 | number       | السعر الأدنى                                                                                       |
| upperBarrier                 | number       | السعر الأعلى                                                                                       |
| depositAmount                | number       | مبلغ الشراء RFQ                                                                               |
| expiry                       | number         | طابع زمن انتهاء الصلاحية (على سبيل المثال، 1672387200)                                                               |
| timestamp                    | number         | وقت تفعيل التسعير الحالي؛ يتم حساب وقت بدء الملاحظة التالي بناءً على هذه المنطق |
| observationStart             | number         | الوقت المقدر لبدء الملاحظة للدخول والخروج بناءً على الطابع الزمني                        |
| feeRate             | object         | معدل رسوم التداول والتسوية (اختياري)                        |
| leverageInfo             | object         | معلومات القرض (اختياري)                        |
| relevantDollarPrices             | list[object]         | سعر الرمز المطلوب لتحويل سعر RCH وحساب توزيع العملات (اختياري)                       |
| amounts             | object         | المبالغ المحسوبة (اختياري)                       |
| apyInfo             | object         | معلومات سنوية، متاحة للمنتجات غير المرتبطة بالزيادة (اختياري)                     |
| oddsInfo             | object         | معلومات الاحتمالات، متاحة للمنتجات المرتبطة بالزيادة (اختياري)                    |
| quote                        | object       |                                                                                                   |
| \> anchorPrices               | list[string] | 20000000000, 30000000000                                                                          |
| \> makerCollateral            | string       | مبلغ ضمان الصانع                                                                         |
| \> totalCollateral            | string       | إجمالي مبلغ الضمان (المأخذ + الصانع)                                                             |
| \> collateralAtRisk | string       | مطلوب عند الضمان (اختياري)                                                           |
| \> makerBalanceThreshold | string       | حد رصيد الصانع                                                          |
| \> deadline                   | number         | طابع زمن انتهاء الصلاحية (على سبيل المثال، 1672387200)                                                           |
| \> makerWallet                | string       | محفظة الصانع (اختياري)                                                                     |
| \> signature                  | string       | التوقيع (اختياري)                                                                          |

**مثال الطلب**

```
GET rfq/dnt/recommended-list?vault=xxxxxx&chainId=1
```

**الاستجابة**

```json
{
    "code":0,
    "message":"",
    "value":[
        {
            "rfqId":1233992,
            "riskType":"PROTECTED",
            "forCcy":"BTC",
            "expiry":1672387200,
            "lowerBarrier":18000,
            "upperBarrier":24000,
            "depositCcy":"BTC",
            "depositAmount": 0.05,
            "protectedApy":0.01,
            "deadline":1672279892,
            "recommended":true,
            "quote":
                {
                    "rfqId":1233992,
                    "inRangeApy":0.25,
                    "tenor":7.9,
                    "fundingAmount":0.25,
                    "depositAmount":1,
                    "premiumCoin":"BTC",
                    "premiumAmount":0.05,
                    "bookingQuantity":0.3,
                    "totalAmount":0.05,
                    "payoff":0.3,
                    "deadline":1672279892,
                    "signature":"dsdkksdsksdk"
                }
            
        }
    ]
}
```

### استفسار DNT

- ملاحظات:
  - يرجى عدم تمرير عنوان محفظة المستخدم في طلب استفسار بسيط.
  - يجب تمرير عنوان محفظة المستخدم فقط عند الاشتراك.

```
GET /rfq/dnt/quote
```

**معلمات الإدخال**

| **اسم الحقل**      | **مطلوب** | **النوع** | **الوصف**                                                                                                            |
| ------------------ | ---------- | --------- | -------------------------------------------------------------------------------------------------------------------- |
| vault              | true         | string   | معلومات العقد                                                                                                   |
| chainId            | true         | int      | معرف السلسلة                                                                                                               |
| expiry             | true         | number     | الطابع الزمني الثانوي لتاريخ انتهاء الصلاحية، على سبيل المثال، 1672387200                                                           |
| lowerBarrier       | true         | number   | السعر الأدنى                                                                                                            |
| upperBarrier       | true         | number   | السعر الأعلى                                                                                                            |
| depositAmount      | true         | number   | مبلغ شراء RFQ                                                                                                    |
| inputApyDefinition | true         | string   | الكود الأساسي هو Enum يشير إلى كيفية حساب APY المدخل: OptimusDefaultAPY، BinanceDntAPY، AaveLendingAPY |
| protectedApy       | false        | number   | العائد السنوي المضمون (فارغ لـ RISKY، مطلوب لـ protected)                                                      |
| fundingApy         | false        | number   | العائد السنوي لـ AAVE (فارغ لـ RISKY، مطلوب لـ protected)                                                            |
| takerWallet        | false        | string   | معلومات عنوان المحفظة العامة للطالب                                                                           |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | int          | 0 يشير إلى أن نتيجة الإرجاع طبيعية   |
| message        | string       | رسالة الخطأ المعادة في حالة حدوث استثناء |
| value          | object       | كما هو موضح أدناه                                 |

الكائن

| **اسم الحقل**               | **النوع**     | **الوصف**                                                                                   |
| ---------------------------- | ------------ | ------------------------------------------------------------------------------------------------- |
| rfqId                        | number       | معرف RFQ                                                                                |
| vault                        | string       | عنوان العقد                                                                                  |
| chainId                      | int          | معرف السلسلة                                                                                          |
| riskType                     | string       | نوع المخاطر: PROTECTED، RISKY                                                                       |
| forCcy                       | string       | العملة الأساسية                                                                               |
| domCcy                       | string       | زوج العملات                                                                                     |
| depositCcy                   | string       | عملة الاشتراك                                                                             |
| lowerBarrier                 | number       | السعر الأدنى                                                                                       |
| upperBarrier                 | number       | السعر الأعلى                                                                                       |
| depositAmount                | number       | مبلغ شراء RFQ                                                                               |
| expiry                       | number         | الطابع الزمني لانتهاء الصلاحية (على سبيل المثال، 1672387200)                                                               |
| timestamp                    | number         | وقت تفعيل التسعير الحالي؛ يتم حساب وقت بدء الملاحظة التالية بناءً على هذه المنطق |
| observationStart             | number         | الوقت المقدر لبدء الملاحظة للدخول والخروج بناءً على الطابع الزمني                        |
| feeRate                      | object         | معدل رسوم التداول والتسوية (اختياري)                        |
| leverageInfo                 | object         | معلومات القرض (اختياري)                        |
| relevantDollarPrices         | list[object]  | سعر الرمز المميز المطلوب لتحويل سعر RCH وحساب الإيجابيات (اختياري)                       |
| amounts                      | object         | المبالغ المحسوبة (اختياري)                       |
| apyInfo             | كائن         | معلومات سنوية، متاحة للمنتجات غير المتزايدة (اختياري)                     |
| oddsInfo             | كائن         | معلومات الاحتمالات، متاحة للمنتجات المتزايدة (اختياري)                    |
| quote                        | كائن       |                                                                                                   |
| \> quoteId               | رقم |                                                                           |
| \> anchorPrices               | قائمة[string] | 20000000000, 30000000000                                                                          |
| \> makerCollateral            | سلسلة       | مقدار ضمان الصانع                                                                         |
| \> totalCollateral            | سلسلة       | إجمالي مقدار الضمان (المأخذ + الصانع)                                                             |
| \> collateralAtRisk | سلسلة       | مطلوب عند الضمان (اختياري)                                                           |
| \> makerBalanceThreshold | سلسلة       | حد رصيد الصانع                                                          |
| \> deadline                   | رقم         | طابع زمني انتهاء الصلاحية (مثل، 1672387200)                                                           |
| \> makerWallet                | سلسلة       | محفظة الصانع (اختياري)                                                                     |
| \> signature                  | سلسلة       | التوقيع (اختياري)                                                                          |

### احتمالية الفوز بـ DNT

احتمالية البقاء ضمن الحدود حتى انتهاء الصلاحية

```
GET rfq/dnt/winning-probabilities
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| forCcy          | صحيح         | سلسلة       | العملة الأساسية      |
| expiry          | صحيح         | رقم     | طابع زمني من المستوى الثاني لتاريخ انتهاء الصلاحية، مثل، 1672387200 |
| lowerBarrier       | صحيح         | رقم   | السعر الأدنى |
| upperBarrier       | صحيح         | رقم   | السعر الأعلى |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | عدد صحيح          | 0 يشير إلى أن نتيجة الإرجاع طبيعية   |
| message        | سلسلة       | رسالة خطأ تم إرجاعها في حالة حدوث استثناء |
| value          | قائمة[كائن] | كما هو موضح أدناه                                 |

كائن

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| spotPrice | رقم | سعر السوق |
| timestamp | رقم |  |
| probabilities | كائن | احتمال الفوز  |

**مثال الطلب**

```
GET rfq/dnt/winning-probabilities?forCcy=BTC&expiry=xxxx&lowerBarrier=xxx&upperBarrier=xxx
```

**الاستجابة**

```json
{
    "code":0,
    "message":"",
    "value": {
        "spotPrice": 62121,
        "timestamp": 1727080594,
        "probabilities": {
            "probDntStayInRange": 0.4,
            "probBullTrendItmLowerStrike": null,
            "probBullTrendItmUpperStrike": null,
            "probBearTrendItmLowerStrike": null,
            "probBearTrendItmUpperStrike": null
        }
    }
}
```

## الاتجاه الذكي

### استعلام قائمة RFQ للاتجاه الذكي الموصى به

```
GET rfq/smart-trend/recommended-list
```

**معلمات الإدخال**

| **اسم الحقل**       | **مطلوب**  | **النوع** | **الوصف**                                         |
| -------------------- | ------------- | -------- | ------------------------------------------------------------ |
| vault              | صحيح          | سلسلة   | معلومات العقد                               |
| chainId            | صحيح          | عدد صحيح      | معرف السلسلة                    |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | عدد صحيح          | 0 يشير إلى أن نتيجة الإرجاع طبيعية   |
| message        | سلسلة       | رسالة الخطأ المعادة في حالة حدوث استثناء |
| value          | قائمة[كائن] | كما هو موضح أدناه                                 |

كائن

| **اسم الحقل**               | **النوع**     | **الوصف**                                                                                   |
| ---------------------------- | ------------ | ------------------------------------------------------------------------------------------------- |
| rfqId                        | عدد       | معرف RFQ                                                                                |
| chainId                      | عدد صحيح          | معرف السلسلة                                                                                          |
| vault                        | سلسلة       | عنوان العقد                                                                                  |
| riskType                     | سلسلة       | نوع المخاطر: محمي، مخاطرة                                                                       |
| direction | سلسلة | صعودي، هبوطي |   
| forCcy                       | سلسلة       | العملة الأساسية                                                                               |
| domCcy                       | سلسلة       | زوج العملات                                                                                     |
| depositCcy                   | سلسلة       | عملة الاشتراك                                                                             |
| lowerBarrier                 | عدد       | السعر الأدنى                                                                                       |
| upperBarrier                 | عدد       | السعر الأعلى                                                                                       |
| depositAmount                | عدد       | مبلغ شراء RFQ                                                                               |
| expiry                       | عدد         | طابع الزمن لانتهاء الصلاحية (مثل، 1672387200)                                                               |
| timestamp                    | عدد         | وقت تفعيل التسعير الحالي؛ يتم حساب وقت بدء الملاحظة التالية بناءً على هذه المنطق |
| feeRate             | كائن         | معدل رسوم التداول والتسوية (اختياري)                        |
| leverageInfo             | كائن         | معلومات القرض (اختياري)                        |
| relevantDollarPrices             | قائمة[كائن]        | سعر الرمز المطلوب لتحويل سعر RCH وحساب الإيجابيات (اختياري)                       |
| amounts             | كائن         | المبالغ المحسوبة (اختياري)                       |
| apyInfo             | كائن         | معلومات سنوية، متاحة للمنتجات غير المتزايدة (اختياري)                     |
| oddsInfo             | كائن         | معلومات الاحتمالات، متاحة للمنتجات المتزايدة (اختياري)                    |
| quote                        | كائن       |                                                                                                   |
| \> anchorPrices               | قائمة[سلسلة] | 20000000000، 30000000000                                                                          |
| \> makerCollateral            | string       | مبلغ ضمان الصانع                                                                         |
| \> totalCollateral            | string       | إجمالي مبلغ الضمان (المأخذ + الصانع)                                                             |
| \> collateralAtRisk | string       | مطلوب عند الضمان (اختياري)                                                           |
| \> makerBalanceThreshold | string       | حد رصيد الصانع                                                          |
| \> deadline                   | number         | طابع زمني لانتهاء الصلاحية (مثل، 1672387200)                                                           |
| \> makerWallet                | string       | محفظة الصانع (اختياري)                                                                     |
| \> signature                  | string       | التوقيع (اختياري)                                                                          |

**مثال على الطلب**

```
GET rfq/smart-trend/recommended-list?vault=xxxxxx
```

### استفسار الاتجاه الذكي

- ملاحظات:
  - يرجى عدم تمرير عنوان محفظة المستخدم في طلب استفسار خالص.
  - يجب تمرير عنوان محفظة المستخدم فقط عند الاشتراك.

```
GET /rfq/smart-trend/quote
```

**معلمات الإدخال**

| **اسم الحقل**     | **مطلوب** | **النوع** | **الوصف**                                                                                                        |
| ------------------ | ------------ | -------- | ---------------------------------------------------------------------------------------------------------------------- |
| vault              | true         | string   | معلومات العقد                                                                                                   |
| chainId            | true         | int      | معرف السلسلة                                                                                                               |
| expiry             | true         | number     | طابع زمني بالثواني لتاريخ انتهاء الصلاحية، مثل، 1672387200                                                           |
| lowerBarrier       | true         | number   | السعر الأدنى                                                                                                            |
| upperBarrier       | true         | number   | السعر الأعلى                                                                                                            |
| depositAmount      | true         | number   | مبلغ شراء RFQ                                                                                                    |
| inputApyDefinition | true         | string   | الكود الأساسي هو Enum يشير إلى كيفية حساب APY المدخل: OptimusDefaultAPY، BinanceDntAPY، AaveLendingAPY |
| protectedApy       | false        | number   | العائد السنوي المضمون (فارغ لـ RISKY، مطلوب لـ protected)                                                      |
| fundingApy         | false        | number   | العائد السنوي لـ AAVE (فارغ لـ RISKY، مطلوب لـ protected)                                                            |
| takerWallet        | false        | string   | معلومات عنوان المحفظة العامة للطالب للاستفسار                                                                           |

**معلمات الاستجابة**

| **اسم الحقل**               | **النوع**     | **الوصف**                                      |
| ---------------------------- | ------------ | ---------------------------------------------- |
| code                         | int          | 0 يشير إلى أن نتيجة الإرجاع طبيعية              |
| message                      | string       | رسالة الخطأ المعادة في حالة حدوث استثناء      |
| value                        | object       | كما هو موضح أدناه                              |

كائن

| **اسم الحقل**               | **النوع**     | **الوصف**                                                                                   |
| ---------------------------- | ------------ | ------------------------------------------------------------------------------------------------- |
| rfqId                        | number       | معرف RFQ                                                                                       |
| vault                        | string       | عنوان العقد                                                                                     |
| chainId                      | int          | معرف السلسلة                                                                                   |
| riskType                     | string       | نوع المخاطر: محمي، محفوف بالمخاطر                                                             |
| direction                    | string       | صعودي، هبوطي                                                                                   |
| forCcy                       | string       | العملة الأساسية                                                                                |
| domCcy                       | string       | زوج العملات                                                                                    |
| depositCcy                   | string       | عملة الاشتراك                                                                                  |
| lowerBarrier                 | number       | السعر الأدنى                                                                                    |
| upperBarrier                 | number       | السعر الأعلى                                                                                    |
| depositAmount                | number       | مبلغ شراء RFQ                                                                                  |
| expiry                       | number       | طابع زمني انتهاء الصلاحية (مثل، 1672387200)                                                  |
| timestamp                    | number       | وقت تفعيل التسعير الحالي؛ يتم حساب وقت بدء الملاحظة التالية بناءً على هذه المنطق              |
| feeRate                      | object       | معدل رسوم التداول والتسوية (اختياري)                                                         |
| leverageInfo                 | object       | معلومات القرض (اختياري)                                                                        |
| relevantDollarPrices         | list[object] | سعر الرمز المطلوب لتحويل سعر RCH وحساب الإهداء (اختياري)                                      |
| amounts                      | object       | المبالغ المحسوبة (اختياري)                                                                     |
| apyInfo                      | object       | معلومات سنوية، متاحة للمنتجات غير المتزايدة (اختياري)                                        |
| oddsInfo                     | object       | معلومات الاحتمالات، متاحة للمنتجات المتزايدة (اختياري)                                       |
| quote                        | object       |                                                                                                   |
| \> quoteId                  | number       |                                                                                                   |
| \> anchorPrices              | list[string] | 20000000000، 30000000000                                                                         |
| \> makerCollateral           | string       | مبلغ ضمان الصانع                                                                                |
| \> totalCollateral           | string       | إجمالي مبلغ الضمان (المأخذ + الصانع)                                                           |
| \> collateralAtRisk          | string       | مطلوب عند الضمان (اختياري)                                                                     |
| \> makerBalanceThreshold      | string       | حد رصيد الصانع                                                                                  |
| \> deadline                   | number       | طابع زمني انتهاء الصلاحية (مثل، 1672387200)                                                  |
| \> makerWallet                | string       | محفظة الصانع (اختياري)                                                                         |
| \> signature                  | string       | التوقيع (اختياري)                                                                               |

### احتمالية الفوز في الاتجاه الذكي

احتمالية البقاء ضمن الحدود حتى انتهاء الصلاحية

```
GET rfq/smart-trend/winning-probabilities
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| forCcy          | صحيح         | سلسلة       | العملة الأساسية      |
| expiry          | صحيح         | رقم     | الطابع الزمني من المستوى الثاني لتاريخ انتهاء الصلاحية، على سبيل المثال، 1672387200 |
| lowerBarrier       | صحيح         | رقم   | السعر الأدنى |
| upperBarrier       | صحيح         | رقم   | السعر الأعلى |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | عدد صحيح          | 0 يشير إلى أن نتيجة العودة طبيعية   |
| message        | سلسلة       | رسالة خطأ تم إرجاعها في حالة حدوث استثناء |
| value          | قائمة[كائن] | كما هو موضح أدناه                                 |

كائن

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| spotPrice | رقم | السعر الفوري |
| timestamp | رقم |  |
| probabilities | كائن | احتمالية الفوز  |


**مثال على الطلب**

```
GET rfq/smart-trend/winning-probabilities?forCcy=BTC&expiry=xxxx&lowerStrike=xxx&upperStrike=xxx
```

**الاستجابة**

```json
{
    "code":0,
    "message":"",
    "value": {
        "spotPrice": 62121,
        "timestamp": 1727080594,
        "probabilities": {
            "probDntStayInRange": null,
            "probBullTrendItmLowerStrike": 0.4,
            "probBullTrendItmUpperStrike": 0.4,
            "probBearTrendItmLowerStrike": 0.6,
            "probBearTrendItmUpperStrike": 0.6,
        }
    }
}
```

## الواجهة العامة

### حذف RFQ

احذف RFQ الذي تم تسجيله على السلسلة

```
POST rfq/remove
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| rfqId          | صحيح         | رقم       | .       |

**مثال على الطلب**

```
{  
"rfqId":123456  
}
```

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | int          | 0 يشير إلى أن نتيجة الإرجاع طبيعية   |
| message        | string       | رسالة الخطأ المعادة في حالة حدوث استثناء |
| value          | object       | .                               |


### إشعار المعاملة

```
POST rfq/trade
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| quotes | true | list[object] |   |
| \> rfqId | true | number |     |
| \> quoteId | true | number |     |
| \> txId | true | string | تجزئة المعاملة |
| code | false | string | رمز الدعوة |
| walletType | false | string | نوع المحفظة، مثل MetaMask، OKX Wallet، Coinbase، إلخ. |

**مثال على الطلب**

```
{
    "quotes": [
        {
            "rfqId": 123456,
            "quoteId": 333,
```

```json
            "txId": "adsswe"
        }
    ],
    "code": "adsswe"
}
```

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | int          | 0 يشير إلى أن نتيجة الإرجاع طبيعية   |
| message        | string       | رسالة الخطأ المعادة في حالة حدوث استثناء |
| value          | object       | .                               |

### قائمة الضربات

```
GET rfq/strike-list
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| indexPrice | true | number |  |
| forCcy | false | string | لزوج تداول BTC-USDT، أدخل BTC هنا؛ إذا لم يتم توفيره، سيتم استخدام التكوين الافتراضي. |
| domCcy | false | string | لزوج تداول BTC-USDT، أدخل USDT هنا؛ إذا لم يتم توفيره، سيكون الافتراضي هو USDT. |


**مثال على الطلب**

```
{  
"indexPrice": 3750.8，  
"forCcy": "WBTC",  
}
```

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| strikes | قائمة[رقم] | قائمة أسعار التنفيذ الموصى بها افتراضيًا |

### قائمة انتهاء الصلاحية

```
GET rfq/expiry-list
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| vault | صحيح | سلسلة | عنوان العقد |
| chainId | صحيح | عدد صحيح | معرف السلسلة |


**مثال على الطلب**

```
{  
"vault": "XXXXXXXXXXXXXX",  
"chainId": 1,  
}
```

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| timestamp | رقم | الوقت الأساسي للبداية في طابع زمني بالثواني |
| expiries | قائمة[رقم] | قائمة انتهاء الصلاحية المدعومة في طابع زمني بالثواني، مثل 1672387200 |

### Aave apy

```
GET rfq/aave-apy
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| chainId | صحيح | رقم |     |
| ccy | صحيح | سلسلة | USDT |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| chainId | رقم | معرف السلسلة |
| ccy | سلسلة | عملة الإيداع |
| avgApy | سلسلة | متوسط APY المسجل على السلسلة خلال الثلاثين يومًا الماضية |
| currentApy | سلسلة | أحدث APY من AAVE |
| apyUsed | سلسلة | APY المستخدم فعليًا في SofaServer لتقدير دخل الفائدة المستقبلي |
| apyDefinition | سلسلة | تعريف الحساب المتعلق بـ APY |

**مثال على الاستجابة**

```
{  
"chainId": 1,  
"ccy":"USDT",  
"avgApy":"0.23442",  
"currentApy":"0.23442",  
"apyUsed":"0.23442",  
"apyDefinition":"AAVE_LENDING_APY"  
}
```

### Apy

```
GET rfq/apy
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| chainId | true | number |     |
| ccy | true | string | USDT |
| apyDefinition | false | string | تعريف الحساب المتعلق بـ APY؛ الافتراضي هو AaveLendingApy |


**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| chainId | number | معرف السلسلة |
| ccy | string | عملة الإيداع |
| avgApy | string | متوسط APY المسجل على السلسلة خلال الثلاثين يومًا الماضية |
| currentApy | string | أحدث APY |
| apyUsed | string | APY المستخدم فعليًا في SofaServer لتقدير دخل الفائدة المستقبلي |
| apyDefinition | string | تعريف الحساب المتعلق بـ APY |

**مثال على الاستجابة**

```
{  
"chainId": 1,  
"ccy":"USDT",  
"avgApy":"0.23442",  
"currentApy":"0.23442",  
"apyUsed":"0.23442",  
"apyDefinition":"AAVE_LENDING_APY"  
}
```

### الحصول على مراكز المحفظة

```
POST /rfq/position-list
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |

| --- | --- | --- | --- |
| chainId | true | Int |  |
| vaults | false | list[string] | مجموعة من عناوين العقود؛ إذا لم يتم تقديمها، سيتم استعلام جميع العقود. |
| claimed | false | boolean | ما إذا تم استردادها؛ إذا لم يتم تقديمها، سيتم استعلام مواقع جميع الحالات. |
| expired | false | boolean | ما إذا كانت قد انتهت؛ إذا لم يتم تقديمها، سيتم استعلام مواقع جميع الحالات. |
| concealed | false | boolean | ما إذا كانت مخفية؛ إذا لم يتم تقديمها، سيتم استعلام مواقع جميع الحالات. |
| positiveReturn | false | boolean | ما إذا كانت قيمة الاسترداد أكبر من 0؛ إذا لم يتم تقديمها، سيتم استعلام جميع المواقع. |
| positiveProfit | false | boolean | ما إذا كانت العائدات تتجاوز رأس المال؛ إذا لم يتم تقديمها، سيتم استعلام جميع المواقع. |
| limit | false | Int | عدد الاستعلامات؛ الافتراضي هو 100، والحد الأقصى هو 300. |
| startDateTime | false | number | الطابع الزمني المقابل بالثواني (شامل)، على سبيل المثال، 1672387200. |
| endDateTime | false | number | الطابع الزمني المقابل بالثواني (شامل)، على سبيل المثال، 1672387200. |
| orderBy | false | string | "createdAt" أو "return"، طريقة الفرز: "createdAt" (وقت التحديث، الافتراضي) أو "return" (العوائد). |
| orderDirection | false | string | "desc" أو "asc"، الافتراضي هو "desc" (ترتيب تنازلي). |
| wallet | false | string | عنوان المحفظة (إذا كان فارغًا، سيتم استعلام جميع عناوين المحفظة). |

ملاحظة: إذا تجاوز عدد النتائج 300 ضمن `startDateTime` و `endDateTime` المحددين، يمكن استخدام الاستطلاع (في هذه الحالة، يجب تعيين `orderBy` إلى `"createdAt"`) لمتابعة الاستعلام. يجب تعيين معلمة `endDateTime` لطلب الاستطلاع nth إلى `createdAt` للسجل الأخير من نتيجة الاستطلاع (n-1). بعد استرداد جميع البيانات، يجب إزالة التكرارات بناءً على حقل `id`.

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code | number |  |
| message | string |  |
| value | list[object] | كما هو موضح أدناه |

كائن

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| id | string | معرف المنتج المقابل للموقع (يتطابق مع `productId` في بيانات The Graph). هذا المعرف فريد ضمن بُعد السلسلة + الخزنة ويمكن استخدامه لاستعلام أرصدة المواقع. |
| positionId | string | معرف الموقع، والذي يكون فريدًا ضمن بُعد السلسلة. |
| product | object | معلومات المنتج. |
| wallet | string | عنوان المحفظة. |
| createdAt | number | الطابع الزمني المقابل بالثواني، على سبيل المثال، 1672387200. |
| updatedAt | number | الطابع الزمني المقابل بالثواني، على سبيل المثال، 1672387200. |
| claimed | boolean | ما إذا تم استرداد الموقع. |
| takerAllocationRate | number | بناءً على وقت الحساب، يقدر النسبة التي يمكن للمالك أخذها من مجموعة الرهانات. قبل انتهاء الصلاحية، هذه قيمة تقديرية. |
| triggerTime | number | بالنسبة لـ Rangebound، أول وقت اختراق؛ بالنسبة لـ non-Rangebound، وقت التسوية، بالثواني. |
| triggerPrice | number | بالنسبة لـ Rangebound، أول سعر اختراق؛ بالنسبة لـ non-Rangebound، سعر التسوية. |
| feeRate | object | معدل الرسوم. |
| leverageInfo | object | معلومات القرض (اختياري). |
| relevantDollarPrices | list[object] | أسعار الرموز المطلوبة لتحويل سعر RCH وحساب توزيع العملات. |
| amounts | object | المبالغ المحسوبة. |
| apyInfo | object | معلومات سنوية، متاحة للمنتجات غير المرتبطة بـ Surge. |
| oddsInfo | object | معلومات الاحتمالات، متاحة للمنتجات المرتبطة بـ Surge. |
| claimParams | object | معلومات معلمات المطالبة. |

**مثال على الاستجابة**

```
{
    "value": [{
        ...
    }]
}
```

### الحصول على معاملات المحفظة

```
POST /rfq/transaction-list
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| chainId | true | Int |  |
| vaults | false | list[string] | مجموعة من عناوين العقود؛ إذا لم يتم توفيرها، سيتم استعلام جميع العقود. |
| limit | false | Int | عدد الاستعلامات؛ الافتراضي هو 100، والحد الأقصى هو 300. |
| startDateTime | false | number | الطابع الزمني المقابل بالثواني (شامل)، على سبيل المثال، 1672387200. |
| endDateTime | false | number | الطابع الزمني المقابل بالثواني (شامل)، على سبيل المثال، 1672387200. |
| orderDirection | false | string | "desc" أو "asc"، الافتراضي هو "desc" (ترتيب تنازلي). |
| taker | false | string | عنوان محفظة المتلقي |
| maker | false | string | عنوان محفظة الصانع |
| claimParams | false | object | معلمات الاسترداد، المقابلة لحقل claimParams في بيانات قائمة المراكز. |
| hash | false | string | تجزئة المعاملة |

ملاحظة: يمكن استخدام معلمات المتلقي، الصانع، وclaimParams لاستعلام مشترك للعثور على سجلات التجارة المقابلة لمركز (قد يتوافق المركز مع عدة تجارات) (ليس من الضروري وجود جميع المعلمات).
إذا تجاوز عدد النتائج 300 ضمن `startDateTime` و`endDateTime` المحددين، يمكن استخدام الاستطلاع (في هذه الحالة، يجب تعيين `orderBy` إلى `"createdAt"`) لمتابعة الاستعلام. يجب تعيين معلمة `endDateTime` لطلب الاستطلاع nth إلى `createdAt` للسجل الأخير من نتيجة الاستطلاع (n-1). بعد استرداد جميع البيانات، يجب إزالة التكرارات بناءً على حقل `id`.

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code | number |  |
| message | string |  |
| value | list[object] | كما هو موضح أدناه |

كائن

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| id | string |  |
| hash | string | تجزئة المعاملة |
| takerWallet | string | عنوان محفظة المشتري. |
| makerWallet | string | عنوان محفظة البائع. |
| product | object | معلومات المنتج. |
| createdAt | number | الطابع الزمني المقابل بالثواني، على سبيل المثال، 1672387200. |
| takerAllocationRate | number | بناءً على وقت الحساب، يقدر النسبة التي يمكن للمالك أخذها من مجموعة الرهانات. قبل انتهاء الصلاحية، هذه قيمة تقديرية. |
| triggerTime | number | بالنسبة للحدود، أول وقت للاختراق؛ بالنسبة لغير الحدود، وقت التسوية، بالثواني. |
| triggerPrice | number | بالنسبة للحدود، أول سعر للاختراق؛ بالنسبة لغير الحدود، سعر التسوية. |
| feeRate | object | معدل الرسوم. |
| leverageInfo | object | معلومات القرض (اختياري). |
| relevantDollarPrices | list[object] | أسعار الرموز المطلوبة لتحويل سعر RCH وحساب توزيع الجوائز. |
| amounts | object | المبالغ المحسوبة. |
| apyInfo | object | معلومات سنوية، متاحة للمنتجات غير المتزايدة. |
| oddsInfo | object | معلومات الاحتمالات، متاحة للمنتجات المتزايدة. |

**مثال على الاستجابة**

```
{
    "value": [{
        ...
    }]
}
```

### إخفاء مراكز الخسارة

```
POST rfq/position/conceal
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| chainId | صحيح | int | معرف السلسلة |
| positionIds | صحيح | List[string] | قائمة معرفات المواقع، حتى 20 |

**مثال على الطلب**

```
{
    "positionIds": [
        "aaaa","bbbb"
    ],
    "chainId": 1
}
```

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code           | int          | 0 يشير إلى أن النتيجة المرجعة طبيعية   |
| message        | string       | رسالة خطأ تم إرجاعها في حالة حدوث استثناء |
| value          | object       | .                               |


### الحصول على المعاملات المعلقة

هذا يهدف بشكل أساسي إلى معالجة مشكلة مزامنة بيانات المواقع الأساسية. قد تختفي البيانات المسترجعة هنا (بسبب منافسة تفرع blockchain).

```
POST rfq/transactions/pending
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| chainId | صحيح | Int |  |
| vaults | غير صحيح | list[string] | مجموعة من عناوين العقود؛ إذا لم يتم توفيرها، سيتم استعلام جميع العقود. |
| taker | غير صحيح | string | عنوان محفظة المشتري |
| maker | غير صحيح | string | عنوان محفظة البائع |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code | number |  |
| message | string |  |
| value | list[object] | كما هو موضح أدناه |

كائن

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| id | string |  |
| hash | string | هاش المعاملة |
| takerWallet | string | عنوان محفظة المشتري. |
| makerWallet | string | عنوان محفظة البائع. |
| product | object | معلومات المنتج. |
| createdAt | number | الطابع الزمني المقابل بالثواني، مثل 1672387200. |
| takerAllocationRate | number | بناءً على وقت الحساب، يقدر النسبة التي يمكن للمالك أخذها من مجموعة الرهانات. قبل انتهاء الصلاحية، هذه قيمة تقديرية. |
| triggerTime | number | بالنسبة للحدود، أول وقت للاختراق؛ بالنسبة لغير الحدود، وقت التسوية، بالثواني. |
| triggerPrice | number | بالنسبة للحدود، أول سعر للاختراق؛ بالنسبة لغير الحدود، سعر التسوية. |
| feeRate | object | معدل الرسوم. |
| leverageInfo | object | معلومات القرض (اختياري). |
| relevantDollarPrices | list[object] | أسعار الرموز المطلوبة لتحويل سعر RCH وحساب الإيجابيات. |
| amounts | object | المبالغ المحسوبة. |
| apyInfo | object | معلومات سنوية، متاحة للمنتجات غير المتزايدة. |
| oddsInfo | object | معلومات الاحتمالات، متاحة للمنتجات المتزايدة. |


### احصل على تاريخ توزيع RCH

```
GET rfq/airdrop/history
```

**معلمات الإدخال**

| **اسم الحقل** | **مطلوب** | **النوع** | **الوصف** |
| --- | --- | --- | --- |
| wallet | true | string | عنوان المحفظة |
| startDateTime | true | number | الطابع الزمني المقابل بالثواني (شامل)، على سبيل المثال، 1672387200. |
| endDateTime | true | number | الطابع الزمني المقابل بالثواني (شامل)، على سبيل المثال، 1672387200. |
| orderBy | false | string | "dateTime" أو "rch"، طريقة الفرز: "dateTime" (وقت الإيصال، الافتراضي) أو "rch" (المبلغ). |
| orderDirection | false | string | "desc" أو "asc"، الافتراضي هو "desc" (ترتيب تنازلي). |

**معلمات الاستجابة**

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| code | number |  |
| message | string |  |
| value | list[object] | كما هو موضح أدناه |

كائن

| **اسم الحقل** | **النوع**     | **الوصف**                                |
| -------------- | ------------ | ---------------------------------------------- |
| dateTime | long | الطابع الزمني الحالي بالثواني، على سبيل المثال، 1672387200. |
| wallet | string | عنوان المحفظة |
| volume | string | حجم التداول |
| rch | string | مقدار الإيصال، القيمة الخام، تحتاج إلى القسمة على 1e18 |
| merkleProof | string | دليل ميركل |
